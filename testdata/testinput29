# Tests for the pattern rewriter which precedes regex compilation (with UTF)

#pattern utf

# Unicode property property escape sequences can be pulled out
/\p{Greek}a|\p{Greek}b/B

# Handling of script runs:
# Script runs can be pulled out
# ⇒ (*sr:..)[ab]
/(*sr:..)a|(*sr:..)b/B

# Common prefix can be pulled out from alternation in a script run:
# ⇒ (*sr:ab[cd])
/(*sr:abc|abd)/B

# Script runs themselves can also be part of a common prefix
# ⇒ (*sr:abc)[cd]
/(*sr:abc)c|(*sr:abc)d/B

# But if there are backtracking control verbs like (*COMMIT) in a script run
# it won't be pulled out
/(*sr:ab(*COMMIT))c|(*sr:ab(*COMMIT))d/B

# Same deal if there is a callout inside a script run
/(*sr:ab(?C1))c|(*sr:ab(?C1))d/B

# All the above applies to ATOMIC script runs
/(*asr:abc|abd)/B

/(*asr:abc)c|(*asr:abc)d/B

/(*asr:ab(*COMMIT))c|(*asr:ab(*COMMIT))d/B

/(*asr:ab(?C1))c|(*asr:ab(?C1))d/B
